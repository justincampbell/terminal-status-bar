#!/bin/bash

power() {
  remaining=`pmset -g batt | grep "discharging" | cut -f 4 -d " "`

  if [[ $remaining == "" ]]; then
    echo -n " üîå "
  else
    if [[ $remaining == "(no" ]]; then remaining="?:??"; fi

    if [[ $remaining =~ ^0: ]]; then
      echo -n " ~$remaining ‚ùóÔ∏èüîã "
    else
      echo -n " ~$remaining üîã "
    fi
  fi
}

network() {
  if scutil -r 8.8.8.8 | grep "^Reachable$" > /dev/null; then
    echo -n " üì∂ "
  else
    echo -n " ‚ùå "
  fi
}

show_help() {
  echo "tmux-status-bar"
  echo "github.com/justincampbell/tmux-status-bar"
  echo ""
  echo "  Options:"
  echo "    -n  Network: a signal bar icon, or a red X"
  echo "    -p  Power:   a plug or battery, with the time remaining"
}

args=""

while getopts "hnp" opt; do
  args="$args"$opt

  case "$opt" in
    h)
      show_help
      exit 0
      ;;
    n)
      network
      ;;
    p)
      power
      ;;
  esac
done

if [ -z "$args" ]; then
  show_help
  exit 1
else
  echo ""
fi
